<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Submit Review - TransitRate</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Core Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/typed.js/2.0.12/typed.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/splitting@1.0.6/dist/splitting.css">
    <script src="https://unpkg.com/splitting@1.0.6/dist/splitting.min.js"></script>
    
    <!-- Custom Styles -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #1e3a8a 0%, #0891b2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .nav-blur {
            backdrop-filter: blur(20px);
            background: rgba(255, 255, 255, 0.9);
        }
        
        .form-card {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .step-indicator {
            transition: all 0.3s ease;
        }
        
        .step-indicator.active {
            background: #3b82f6;
            color: white;
        }
        
        .step-indicator.completed {
            background: #10b981;
            color: white;
        }
        
        .star-rating {
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .star-rating:hover {
            transform: scale(1.1);
        }
        
        .star-rating.filled {
            color: #fbbf24;
        }
        
        .star-rating.empty {
            color: #d1d5db;
        }
        
        .progress-bar {
            transition: width 0.3s ease;
        }
        
        .word-counter {
            font-variant-numeric: tabular-nums;
        }
        
        .quality-indicator {
            transition: all 0.3s ease;
        }
        
        .quality-indicator.poor {
            background: #fee2e2;
            color: #dc2626;
        }
        
        .quality-indicator.fair {
            background: #fef3c7;
            color: #d97706;
        }
        
        .quality-indicator.good {
            background: #d1fae5;
            color: #059669;
        }
        
        .quality-indicator.excellent {
            background: #dbeafe;
            color: #2563eb;
        }
        
        .form-step {
            display: none;
        }
        
        .form-step.active {
            display: block;
        }
        
        .file-upload-area {
            border: 2px dashed #d1d5db;
            transition: all 0.3s ease;
        }
        
        .file-upload-area:hover {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }
        
        .file-upload-area.dragover {
            border-color: #1d4ed8;
            background-color: #dbeafe;
        }
        
        .preview-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-900">
    <!-- Navigation -->
    <nav class="fixed top-0 left-0 right-0 z-50 nav-blur border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
                        <span class="text-white font-bold text-sm">TR</span>
                    </div>
                    <span class="text-xl font-bold gradient-text">TransitRate</span>
                </div>
                
                <div class="hidden md:flex items-center space-x-8">
                    <a href="index.html" class="text-gray-700 hover:text-blue-600 transition-colors font-medium">Home</a>
                    <a href="india-transit.html" class="text-gray-700 hover:text-blue-600 transition-colors font-medium">India Transit</a>
                    <a href="dashboard.html" class="text-gray-700 hover:text-blue-600 transition-colors font-medium">Dashboard</a>
                    <a href="reviews.html" class="text-gray-700 hover:text-blue-600 transition-colors font-medium">Reviews</a>
                    <a href="submit-review.html" class="text-blue-600 font-medium">Submit Review</a>
                </div>
                
                <div class="md:hidden">
                    <button id="mobile-menu-btn" class="text-gray-700 hover:text-blue-600">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Header Section -->
    <section class="pt-24 pb-8 bg-white">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-gray-800 mb-4" data-splitting>Submit Your Review</h1>
                <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                    Share your transit experience to help improve public transportation for everyone
                </p>
            </div>
            
            <!-- Progress Indicator -->
            <div class="mb-8">
                <div class="flex items-center justify-center space-x-4 mb-4">
                    <div class="step-indicator active w-10 h-10 rounded-full flex items-center justify-center font-semibold" data-step="1">1</div>
                    <div class="w-16 h-1 bg-gray-200 rounded"></div>
                    <div class="step-indicator w-10 h-10 rounded-full flex items-center justify-center font-semibold bg-gray-200 text-gray-600" data-step="2">2</div>
                    <div class="w-16 h-1 bg-gray-200 rounded"></div>
                    <div class="step-indicator w-10 h-10 rounded-full flex items-center justify-center font-semibold bg-gray-200 text-gray-600" data-step="3">3</div>
                    <div class="w-16 h-1 bg-gray-200 rounded"></div>
                    <div class="step-indicator w-10 h-10 rounded-full flex items-center justify-center font-semibold bg-gray-200 text-gray-600" data-step="4">4</div>
                </div>
                <div class="text-center">
                    <div class="text-sm text-gray-600">
                        <span id="step-description">Route Selection & Verification</span>
                    </div>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2 mt-4">
                    <div class="progress-bar bg-blue-600 h-2 rounded-full" style="width: 25%"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Form Section -->
    <section class="py-8">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <form id="review-form" class="form-card rounded-2xl p-8 shadow-2xl">
                
                <!-- Step 1: Route Selection -->
                <div class="form-step active" id="step-1">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Select Your Route</h2>
                    
                    <div class="space-y-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Which route did you take? *</label>
                            <select id="route-select" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="">Choose a route...</option>
                                <option value="route-15">Route 15 - Downtown Express</option>
                                <option value="route-23">Route 23 - Airport Shuttle</option>
                                <option value="route-7">Route 7 - University Loop</option>
                                <option value="route-42">Route 42 - Shopping District</option>
                                <option value="route-11">Route 11 - Residential Connector</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">When did you take this route? *</label>
                            <input type="date" id="travel-date" required max="2024-09-29" 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Time of travel</label>
                            <select id="travel-time" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="">Select time period...</option>
                                <option value="early-morning">Early Morning (5:00-8:00)</option>
                                <option value="morning-rush">Morning Rush (8:00-10:00)</option>
                                <option value="midday">Midday (10:00-16:00)</option>
                                <option value="evening-rush">Evening Rush (16:00-19:00)</option>
                                <option value="evening">Evening (19:00-22:00)</option>
                                <option value="night">Night (22:00-5:00)</option>
                            </select>
                        </div>
                        
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <div class="flex items-start">
                                <svg class="w-5 h-5 text-blue-600 mt-0.5 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                                </svg>
                                <div>
                                    <h4 class="text-sm font-medium text-blue-800">Verification Required</h4>
                                    <p class="text-sm text-blue-700 mt-1">To ensure authentic reviews, we verify that you've completed the route. Please select the correct route and travel date.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-end mt-8">
                        <button type="button" onclick="nextStep()" class="bg-blue-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-all">
                            Continue to Ratings
                        </button>
                    </div>
                </div>

                <!-- Step 2: Detailed Ratings -->
                <div class="form-step" id="step-2">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Rate Your Experience</h2>
                    
                    <div class="space-y-8">
                        <!-- Overall Rating -->
                        <div class="rating-section">
                            <label class="block text-lg font-medium text-gray-700 mb-3">Overall Route Satisfaction *</label>
                            <div class="flex items-center space-x-2 mb-2" id="overall-rating">
                                <span class="star-rating empty text-4xl" data-rating="1">★</span>
                                <span class="star-rating empty text-4xl" data-rating="2">★</span>
                                <span class="star-rating empty text-4xl" data-rating="3">★</span>
                                <span class="star-rating empty text-4xl" data-rating="4">★</span>
                                <span class="star-rating empty text-4xl" data-rating="5">★</span>
                            </div>
                            <div class="text-sm text-gray-600" id="overall-rating-text">Click to rate your overall experience</div>
                        </div>

                        <!-- Detailed Criteria -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="rating-section">
                                <label class="block text-lg font-medium text-gray-700 mb-3">Punctuality</label>
                                <div class="flex items-center space-x-2 mb-2" id="punctuality-rating">
                                    <span class="star-rating empty text-3xl" data-rating="1">★</span>
                                    <span class="star-rating empty text-3xl" data-rating="2">★</span>
                                    <span class="star-rating empty text-3xl" data-rating="3">★</span>
                                    <span class="star-rating empty text-3xl" data-rating="4">★</span>
                                    <span class="star-rating empty text-3xl" data-rating="5">★</span>
                                </div>
                                <div class="text-sm text-gray-600">Was the bus on time?</div>
                            </div>

                            <div class="rating-section">
                                <label class="block text-lg font-medium text-gray-700 mb-3">Cleanliness</label>
                                <div class="flex items-center space-x-2 mb-2" id="cleanliness-rating">
                                    <span class="star-rating empty text-3xl" data-rating="1">★</span>
                                    <span class="star-rating empty text-3xl" data-rating="2">★</span>
                                    <span class="star-rating empty text-3xl" data-rating="3">★</span>
                                    <span class="star-rating empty text-3xl" data-rating="4">★</span>
                                    <span class="star-rating empty text-3xl" data-rating="5">★</span>
                                </div>
                                <div class="text-sm text-gray-600">How clean was the bus?</div>
                            </div>

                            <div class="rating-section">
                                <label class="block text-lg font-medium text-gray-700 mb-3">Driver Professionalism</label>
                                <div class="flex items-center space-x-2 mb-2" id="driver-rating">
                                    <span class="star-rating empty text-3xl" data-rating="1">★</span>
                                    <span class="star-rating empty text-3xl" data-rating="2">★</span>
                                    <span class="star-rating empty text-3xl" data-rating="3">★</span>
                                    <span class="star-rating empty text-3xl" data-rating="4">★</span>
                                    <span class="star-rating empty text-3xl" data-rating="5">★</span>
                                </div>
                                <div class="text-sm text-gray-600">Driver behavior and service</div>
                            </div>

                            <div class="rating-section">
                                <label class="block text-lg font-medium text-gray-700 mb-3">Comfort Level</label>
                                <div class="flex items-center space-x-2 mb-2" id="comfort-rating">
                                    <span class="star-rating empty text-3xl" data-rating="1">★</span>
                                    <span class="star-rating empty text-3xl" data-rating="2">★</span>
                                    <span class="star-rating empty text-3xl" data-rating="3">★</span>
                                    <span class="star-rating empty text-3xl" data-rating="4">★</span>
                                    <span class="star-rating empty text-3xl" data-rating="5">★</span>
                                </div>
                                <div class="text-sm text-gray-600">Seating and ride quality</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-between mt-8">
                        <button type="button" onclick="prevStep()" class="bg-gray-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-gray-700 transition-all">
                            Back
                        </button>
                        <button type="button" onclick="nextStep()" class="bg-blue-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-all">
                            Continue to Review
                        </button>
                    </div>
                </div>

                <!-- Step 3: Written Review -->
                <div class="form-step" id="step-3">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Share Your Experience</h2>
                    
                    <div class="space-y-6">
                        <div>
                            <label class="block text-lg font-medium text-gray-700 mb-3">Detailed Review *</label>
                            <textarea id="review-content" rows="8" required 
                                      placeholder="Tell us about your experience. What did you like? What could be improved? (Minimum 50 characters)"
                                      class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"></textarea>
                            
                            <div class="flex items-center justify-between mt-2">
                                <div class="text-sm text-gray-600">
                                    Word count: <span id="word-counter" class="word-counter">0</span>/50 minimum
                                </div>
                                <div id="quality-indicator" class="quality-indicator poor text-xs px-3 py-1 rounded-full">
                                    Needs more detail
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-lg font-medium text-gray-700 mb-3">Add Photos (Optional)</label>
                            <div class="file-upload-area rounded-lg p-8 text-center cursor-pointer" id="file-upload">
                                <svg class="mx-auto h-12 w-12 text-gray-400 mb-4" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                                    <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                </svg>
                                <div class="text-lg font-medium text-gray-700 mb-2">Drop images here or click to upload</div>
                                <div class="text-sm text-gray-600">PNG, JPG up to 5MB each. Maximum 3 photos.</div>
                                <input type="file" id="photo-input" accept="image/*" multiple class="hidden">
                            </div>
                            
                            <div id="photo-preview" class="grid grid-cols-3 gap-4 mt-4 hidden">
                                <!-- Photo previews will be added here -->
                            </div>
                        </div>
                        
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                            <div class="flex items-start">
                                <svg class="w-5 h-5 text-green-600 mt-0.5 mr-3" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                                </svg>
                                <div>
                                    <h4 class="text-sm font-medium text-green-800">Writing Tips</h4>
                                    <ul class="text-sm text-green-700 mt-1 list-disc list-inside">
                                        <li>Be specific about what you liked or disliked</li>
                                        <li>Mention specific aspects like timing, cleanliness, or driver behavior</li>
                                        <li>Keep it constructive and helpful for other riders</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-between mt-8">
                        <button type="button" onclick="prevStep()" class="bg-gray-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-gray-700 transition-all">
                            Back
                        </button>
                        <button type="button" onclick="nextStep()" class="bg-blue-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-all">
                            Review & Submit
                        </button>
                    </div>
                </div>

                <!-- Step 4: Review & Submit -->
                <div class="form-step" id="step-4">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Review & Submit</h2>
                    
                    <div class="space-y-6">
                        <!-- Review Summary -->
                        <div class="preview-card rounded-lg p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Review Summary</h3>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h4 class="font-medium text-gray-700 mb-2">Route Information</h4>
                                    <div class="text-sm text-gray-600 space-y-1">
                                        <div>Route: <span id="preview-route" class="font-medium"></span></div>
                                        <div>Travel Date: <span id="preview-date" class="font-medium"></span></div>
                                        <div>Time: <span id="preview-time" class="font-medium"></span></div>
                                    </div>
                                </div>
                                
                                <div>
                                    <h4 class="font-medium text-gray-700 mb-2">Your Ratings</h4>
                                    <div class="text-sm text-gray-600 space-y-1">
                                        <div>Overall: <span id="preview-overall" class="font-medium"></span></div>
                                        <div>Punctuality: <span id="preview-punctuality" class="font-medium"></span></div>
                                        <div>Cleanliness: <span id="preview-cleanliness" class="font-medium"></span></div>
                                        <div>Driver: <span id="preview-driver" class="font-medium"></span></div>
                                        <div>Comfort: <span id="preview-comfort" class="font-medium"></span></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-6">
                                <h4 class="font-medium text-gray-700 mb-2">Your Review</h4>
                                <div id="preview-content" class="text-sm text-gray-600 bg-white p-4 rounded border"></div>
                            </div>
                        </div>
                        
                        <!-- Privacy Options -->
                        <div class="space-y-4">
                            <h3 class="text-lg font-semibold text-gray-800">Privacy Options</h3>
                            
                            <div class="flex items-center space-x-3">
                                <input type="checkbox" id="anonymous" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                                <label for="anonymous" class="text-sm text-gray-700">
                                    Submit anonymously (your name will not be displayed publicly)
                                </label>
                            </div>
                            
                            <div class="flex items-center space-x-3">
                                <input type="checkbox" id="notifications" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500" checked>
                                <label for="notifications" class="text-sm text-gray-700">
                                    Notify me when transit authorities respond to my review
                                </label>
                            </div>
                        </div>
                        
                        <!-- Terms and Conditions -->
                        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                            <div class="flex items-start space-x-3">
                                <input type="checkbox" id="terms" required class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 mt-0.5">
                                <label for="terms" class="text-sm text-gray-700">
                                    I agree to the <a href="#" class="text-blue-600 hover:underline">Terms of Service</a> and 
                                    <a href="#" class="text-blue-600 hover:underline">Privacy Policy</a>. 
                                    I confirm that this review is based on my genuine experience and contains no false information.
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-between mt-8">
                        <button type="button" onclick="prevStep()" class="bg-gray-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-gray-700 transition-all">
                            Back
                        </button>
                        <button type="submit" class="bg-green-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-green-700 transition-all">
                            Submit Review
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <div class="flex items-center justify-center space-x-2 mb-4">
                    <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
                        <span class="text-white font-bold text-sm">TR</span>
                    </div>
                    <span class="text-xl font-bold">TransitRate</span>
                </div>
                <p class="text-gray-400 mb-4">Improving public transportation through community feedback</p>
                <p class="text-sm text-gray-500">© 2024 TransitRate. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Review Form JavaScript
        document.addEventListener('DOMContentLoaded', function() {
            initializeReviewForm();
        });

        let currentStep = 1;
        let ratings = {
            overall: 0,
            punctuality: 0,
            cleanliness: 0,
            driver: 0,
            comfort: 0
        };

        function initializeReviewForm() {
            initializeAnimations();
            initializeRatingSystem();
            initializeFileUpload();
            initializeFormValidation();
            initializeEventListeners();
        }

        function initializeAnimations() {
            // Initialize Splitting.js
            Splitting();
            
            // Animate heading
            anime({
                targets: '[data-splitting] .char',
                translateY: [50, 0],
                opacity: [0, 1],
                easing: 'easeOutExpo',
                duration: 1200,
                delay: anime.stagger(30)
            });
            
            // Animate form card
            anime({
                targets: '.form-card',
                translateY: [30, 0],
                opacity: [0, 1],
                easing: 'easeOutExpo',
                duration: 1000,
                delay: 500
            });
        }

        function initializeRatingSystem() {
            const ratingContainers = ['overall-rating', 'punctuality-rating', 'cleanliness-rating', 'driver-rating', 'comfort-rating'];
            
            ratingContainers.forEach(containerId => {
                const container = document.getElementById(containerId);
                const stars = container.querySelectorAll('.star-rating');
                
                stars.forEach(star => {
                    star.addEventListener('click', function() {
                        const rating = parseInt(this.dataset.rating);
                        const ratingType = containerId.replace('-rating', '');
                        
                        setRating(ratingType, rating);
                        updateRatingDisplay(containerId, rating);
                    });
                    
                    star.addEventListener('mouseenter', function() {
                        const rating = parseInt(this.dataset.rating);
                        highlightStars(containerId, rating);
                    });
                });
                
                container.addEventListener('mouseleave', function() {
                    const ratingType = containerId.replace('-rating', '');
                    updateRatingDisplay(containerId, ratings[ratingType]);
                });
            });
        }

        function setRating(type, rating) {
            ratings[type] = rating;
            
            // Animate rating selection
            const containerId = type + '-rating';
            anime({
                targets: `#${containerId}`,
                scale: [1, 1.05, 1],
                duration: 400,
                easing: 'easeOutElastic(1, .8)'
            });
        }

        function updateRatingDisplay(containerId, rating) {
            const container = document.getElementById(containerId);
            const stars = container.querySelectorAll('.star-rating');
            
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.classList.remove('empty');
                    star.classList.add('filled');
                } else {
                    star.classList.remove('filled');
                    star.classList.add('empty');
                }
            });
        }

        function highlightStars(containerId, rating) {
            const container = document.getElementById(containerId);
            const stars = container.querySelectorAll('.star-rating');
            
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.classList.remove('empty');
                    star.classList.add('filled');
                } else {
                    star.classList.remove('filled');
                    star.classList.add('empty');
                }
            });
        }

        function initializeFileUpload() {
            const fileUploadArea = document.getElementById('file-upload');
            const photoInput = document.getElementById('photo-input');
            const photoPreview = document.getElementById('photo-preview');
            
            fileUploadArea.addEventListener('click', () => photoInput.click());
            
            fileUploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                fileUploadArea.classList.add('dragover');
            });
            
            fileUploadArea.addEventListener('dragleave', () => {
                fileUploadArea.classList.remove('dragover');
            });
            
            fileUploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                fileUploadArea.classList.remove('dragover');
                handleFiles(e.dataTransfer.files);
            });
            
            photoInput.addEventListener('change', (e) => {
                handleFiles(e.target.files);
            });
        }

        function handleFiles(files) {
            const photoPreview = document.getElementById('photo-preview');
            const maxFiles = 3;
            const validFiles = Array.from(files).slice(0, maxFiles);
            
            photoPreview.innerHTML = '';
            
            if (validFiles.length > 0) {
                photoPreview.classList.remove('hidden');
                
                validFiles.forEach((file, index) => {
                    if (file.type.startsWith('image/')) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            const photoDiv = document.createElement('div');
                            photoDiv.className = 'relative';
                            photoDiv.innerHTML = `
                                <img src="${e.target.result}" alt="Photo ${index + 1}" class="w-full h-24 object-cover rounded-lg">
                                <button type="button" class="absolute top-1 right-1 bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-700" onclick="this.parentElement.remove()">
                                    ×
                                </button>
                            `;
                            photoPreview.appendChild(photoDiv);
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
        }

        function initializeFormValidation() {
            const reviewContent = document.getElementById('review-content');
            const wordCounter = document.getElementById('word-counter');
            const qualityIndicator = document.getElementById('quality-indicator');
            
            reviewContent.addEventListener('input', function() {
                const wordCount = this.value.length;
                wordCounter.textContent = wordCount;
                
                // Update quality indicator
                qualityIndicator.className = 'quality-indicator text-xs px-3 py-1 rounded-full ';
                
                if (wordCount < 50) {
                    qualityIndicator.className += 'poor';
                    qualityIndicator.textContent = 'Needs more detail';
                } else if (wordCount < 100) {
                    qualityIndicator.className += 'fair';
                    qualityIndicator.textContent = 'Fair detail';
                } else if (wordCount < 200) {
                    qualityIndicator.className += 'good';
                    qualityIndicator.textContent = 'Good detail';
                } else {
                    qualityIndicator.className += 'excellent';
                    qualityIndicator.textContent = 'Excellent detail';
                }
            });
        }

        function initializeEventListeners() {
            // Form submission
            document.getElementById('review-form').addEventListener('submit', handleFormSubmission);
            
            // Mobile menu
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            if (mobileMenuBtn) {
                mobileMenuBtn.addEventListener('click', function() {
                    // Mobile menu functionality
                });
            }
        }

        function nextStep() {
            if (validateCurrentStep()) {
                if (currentStep < 4) {
                    currentStep++;
                    updateStepDisplay();
                    updateProgressBar();
                    
                    if (currentStep === 4) {
                        populatePreview();
                    }
                }
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                updateStepDisplay();
                updateProgressBar();
            }
        }

        function validateCurrentStep() {
            switch (currentStep) {
                case 1:
                    const routeSelect = document.getElementById('route-select');
                    const travelDate = document.getElementById('travel-date');
                    
                    if (!routeSelect.value) {
                        showNotification('Please select a route', 'warning');
                        return false;
                    }
                    
                    if (!travelDate.value) {
                        showNotification('Please select your travel date', 'warning');
                        return false;
                    }
                    
                    // Check if date is not in future
                    const selectedDate = new Date(travelDate.value);
                    const today = new Date();
                    if (selectedDate > today) {
                        showNotification('Travel date cannot be in the future', 'warning');
                        return false;
                    }
                    
                    return true;
                    
                case 2:
                    if (ratings.overall === 0) {
                        showNotification('Please provide an overall rating', 'warning');
                        return false;
                    }
                    return true;
                    
                case 3:
                    const reviewContent = document.getElementById('review-content');
                    if (reviewContent.value.length < 50) {
                        showNotification('Please write at least 50 characters', 'warning');
                        return false;
                    }
                    return true;
                    
                default:
                    return true;
            }
        }

        function updateStepDisplay() {
            // Hide all steps
            document.querySelectorAll('.form-step').forEach(step => {
                step.classList.remove('active');
            });
            
            // Show current step
            document.getElementById(`step-${currentStep}`).classList.add('active');
            
            // Update step indicators
            document.querySelectorAll('.step-indicator').forEach((indicator, index) => {
                const stepNumber = index + 1;
                indicator.classList.remove('active', 'completed');
                
                if (stepNumber < currentStep) {
                    indicator.classList.add('completed');
                } else if (stepNumber === currentStep) {
                    indicator.classList.add('active');
                }
            });
            
            // Update step description
            const descriptions = {
                1: 'Route Selection & Verification',
                2: 'Detailed Ratings',
                3: 'Written Review',
                4: 'Review & Submit'
            };
            
            document.getElementById('step-description').textContent = descriptions[currentStep];
            
            // Animate step transition
            anime({
                targets: '.form-step.active',
                translateX: [30, 0],
                opacity: [0, 1],
                duration: 500,
                easing: 'easeOutExpo'
            });
        }

        function updateProgressBar() {
            const progress = (currentStep / 4) * 100;
            document.querySelector('.progress-bar').style.width = `${progress}%`;
        }

        function populatePreview() {
            // Route information
            const routeSelect = document.getElementById('route-select');
            const travelDate = document.getElementById('travel-date');
            const travelTime = document.getElementById('travel-time');
            
            document.getElementById('preview-route').textContent = routeSelect.options[routeSelect.selectedIndex].text;
            document.getElementById('preview-date').textContent = new Date(travelDate.value).toLocaleDateString();
            document.getElementById('preview-time').textContent = travelTime.options[travelTime.selectedIndex].text || 'Not specified';
            
            // Ratings
            document.getElementById('preview-overall').textContent = `${ratings.overall}/5 stars`;
            document.getElementById('preview-punctuality').textContent = `${ratings.punctuality || 'Not rated'}/5`;
            document.getElementById('preview-cleanliness').textContent = `${ratings.cleanliness || 'Not rated'}/5`;
            document.getElementById('preview-driver').textContent = `${ratings.driver || 'Not rated'}/5`;
            document.getElementById('preview-comfort').textContent = `${ratings.comfort || 'Not rated'}/5`;
            
            // Review content
            const reviewContent = document.getElementById('review-content');
            document.getElementById('preview-content').textContent = reviewContent.value;
        }

        function handleFormSubmission(e) {
            e.preventDefault();
            
            // Check terms acceptance
            const termsCheckbox = document.getElementById('terms');
            if (!termsCheckbox.checked) {
                showNotification('Please accept the terms and conditions', 'warning');
                return;
            }
            
            // Simulate form submission
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            
            submitBtn.textContent = 'Submitting...';
            submitBtn.disabled = true;
            
            setTimeout(() => {
                showSuccessModal();
            }, 2000);
        }

        function showSuccessModal() {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50';
            modal.innerHTML = `
                <div class="bg-white rounded-2xl p-8 max-w-md mx-4 text-center">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Review Submitted!</h3>
                    <p class="text-gray-600 mb-6">Thank you for sharing your experience. Your review will help improve public transportation for everyone.</p>
                    <button onclick="closeSuccessModal()" class="bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-all">
                        Continue
                    </button>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Animate modal
            anime({
                targets: modal.querySelector('div'),
                scale: [0.8, 1],
                opacity: [0, 1],
                duration: 500,
                easing: 'easeOutElastic(1, .8)'
            });
        }

        function closeSuccessModal() {
            const modal = document.querySelector('.fixed.inset-0');
            if (modal) {
                anime({
                    targets: modal.querySelector('div'),
                    scale: [1, 0.8],
                    opacity: [1, 0],
                    duration: 300,
                    easing: 'easeInQuad',
                    complete: () => {
                        document.body.removeChild(modal);
                        // Redirect to reviews page
                        window.location.href = 'reviews.html';
                    }
                });
            }
        }

        // Notification system
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-20 right-4 z-50 px-6 py-4 rounded-lg shadow-lg text-white font-medium transform translate-x-full transition-transform duration-300`;
            
            const colors = {
                success: 'bg-green-500',
                warning: 'bg-yellow-500',
                error: 'bg-red-500',
                info: 'bg-blue-500'
            };
            
            notification.classList.add(colors[type]);
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            // Animate out and remove
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }
    </script>
    <script src="transitrate.js"></script>
</body>
</html>